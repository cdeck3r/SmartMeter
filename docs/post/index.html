<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="
		
		Engineering Documentation
		"> 
    
	<meta name="author" content=" cdeck3r ">  
    <base href="https://cdeck3r.com/SmartMeter/">
    <title>Sections</title>

    
    <link href="css/bootstrap.min.css" rel="stylesheet">

    
    <link href="css/landing-page.css" rel="stylesheet">

    
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    
    <link href="css/bootstrap-social.css" rel="stylesheet">

    
    
    

    <style>
    .navbar {
    border-color: #e7e7e7;
}

.content-section-a,
footer,
.navbar {
  background-color: #f8f8f8;
  color: #333;
}

.navbar a:link,
.navbar-default .navbar-nav>li>a {
  color: #777;
}

.navbar a:hover,
.navbar-default .navbar-nav>li>a:hover {
  color: rgb(51, 51, 51);
}

.content-section-b {
  background-color: white;
  color: #333;
}

body {
  color: rgb(51, 51, 51);
}

.header-container h1,
.header-container h2,
.header-container h3,
.header-container h4 {
  color: rgb(51, 51, 51);
}
 
  </style>

</head>
<body>

<section id="intro">
	
	<div class="intro-header">

		<div class="container">
			<div class="row">
				<div class="col-lg-12">
				
					<div class="intro-message">
						<h1>SmartMeter</h1>
						<h3>Engineering Documentation</h3>
						<hr class="intro-divider">

						<ul class="list-inline intro-social-buttons">
						


  <li><a href="//github.com/cdeck3r/SmartMeter" class="btn btn-default btn-lg" title="GitHub">
  <i class="fa fa-github"></i>
  </a></li>


























  <li><a href="//linkedin.com/in/cdeck3r" title="LinkedIn" class="btn btn-default btn-lg">
  <i class="fa fa-linkedin"></i>
  </a></li>



















  <li><a href="//youtube.com/channel/UCZ5wNVV_E6AA3L3C-mvqwSA" title="YouTube" class="btn btn-default btn-lg">
  <i class="fa fa-youtube"></i>
  </a></li>













  <li><a href="//instagram.com/cdeck3r" title="Instagram" class="btn btn-default btn-lg">
  <i class="fa fa-instagram"></i>
  </a></li>





  <li><a href="//twitter.com/cdeck3r" title="Twitter" class="btn btn-default btn-lg">
  <i class="fa fa-twitter"></i>
  </a></li>



















  <li><a href="mailto:info@cdeck3r.com" title="Email" class="btn btn-default btn-lg">
  <i class="fa fa-envelope"></i>
  </a></li>


						</ul>
					</div>
				</div>
			</div>
		</div>
		
	</div>
	
</section>

<section id="main">



	 
    <div class="content-section-a">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">About</h2>
                    <p>SmartMeter is hardware/software system for <sup>24</sup>&frasl;<sub>7</sub> recording of the overall electricity consumption in a family home.</p>

<p>It consists of a COTS camera-based embedded computer system which takes pictures of a regular electricity meter. Server software performs an OCR on these pictures and creates a time series report about the overall electricity consumption eventually revealing interesting consumption patterns.</p>

<p>We may gain insights from this report in order to optimze our energy footprint.</p>

                </div>
            </div>

        </div>
        

    </div>

	
    <div class="content-section-b">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">Project Definition</h2>
                    

<p>This is a tiny research project. Apart from the overall goal we want to achieve some learning outcomes.</p>

<h3 id="goal">Goal</h3>

<p>Our goal is to improve our energy footprint. Therefore, SmartMeter aims for a fine-grained tracking of the electricity consumption in a family home.</p>

<h3 id="objectives">Objectives</h3>

<p>The project is less on the hardware side, rather it focusses on software for</p>

<ul>
<li>reliably taking pictures in 15 minutes intervals</li>
<li>data management across various systems at home as well as on the Internet</li>
<li>AI based optical character recognition</li>
<li>unattended operation</li>
<li>fine-grained consumption statistics</li>
</ul>

<h3 id="expected-results">Expected Results</h3>

<ul>
<li><sup>24</sup>&frasl;<sub>7</sub> solution delivering electricity consumption data</li>
<li>Set of real world pictures used for future AI projects</li>
</ul>

<h3 id="learning-outcomes">Learning Outcomes</h3>

<ul>
<li>Methods and tools for AI based image processing</li>
<li>Assess the maturity and ease of use of available tools</li>
</ul>

                </div>
            </div>

        </div>
        

    </div>

	 
    <div class="content-section-a">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">System Design</h2>
                    <style>
img {
  max-width: 100%;
  height: auto;
}
</style>

<p>This use case diagram depicts SmartMeter’s main services.</p>

<p><img src="uml/uc_systemdesign.png" alt="system main services" /></p>

<p>The brief design sketch below shows SmartMeter’s hardware and software components. The local embedded camera system uploads the pictures on Dropbox. The server is a remote host on the Internet downloads them from there and performs the OCR processing.</p>

<p><img src="uml/cp_systemdesign.png" alt="system main components"  /></p>

<p>The current design distributes some main services as well as the data across several systems on the Internet. This has implications on data and privacy protection. Although all connections are encrypted, potentially sensitive data is stored outside the physical boundaries of the house, therewith, making data and privacy vulnerable. Special attention needs to be paid on access restriction as well as on data management, e.g. data retention.</p>

<p>An alternative is to perform all processing on the embedded camera system. This will keep all data local. We leave this for future work.</p>

                </div>
            </div>

        </div>
        

    </div>

	
    <div class="content-section-b">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">Hardware Setup</h2>
                    <style>
img {
  max-width: 100%;
  height: auto;
}
</style>

<p>We use <a href="https://en.wikipedia.org/wiki/Raspberry_Pi">Raspberry Pi 3, Model B+</a> as the platform for the COTS embedded camera system. It connects to a <a href="https://www.geeetech.com/wiki/index.php/Raspberry_Pi_Camera_Module">Raspberry Pi camera module</a>.</p>

<p>The regular electricity meter is inside a switch cabinet. The inner side of the cabinet&rsquo;s door holds the Raspberry Pi and the camera using magnets. The following picture shows the installation.</p>

<p><img src="img/smeter_install.jpg" alt="SmartMeter installation" width="400px"/></p>

<p>There are only 3 centimeters between the meter&rsquo;s display and the cabinet door. The camera looks at the display via the mirror. A Raspberry powered USB light supplies sufficient brightness for the camera to take pictures. The next picture shows the components.</p>

<p><img src="img/smeter_front.jpg" alt="SmartMeter components" width="400px"/></p>

<p>The picture shows how the installation is oriented towards the meter when the door is closed.</p>

<p><img src="img/smeter_inside.jpg" alt="SmartMeter inside" width="400px"/></p>

<p>When operating the camera captures a mirrored image of the electricity meter&rsquo;s display. Rotating and mirroring it will show the number correctly.</p>

<table class='table table-striped table-hover'>
<thead>
<tr>
<th>Original image</th>
<th>Image rotated and mirrored</th>
</tr>
</thead>

<tbody>
<tr>
<td><img src="img/metercam.png" alt="image captured by meter camera" width="75%" /></td>
<td><img src="img/metercam_numbers.png" alt="meter camera" /></td>
</tr>
</tbody>
</table>

                </div>
            </div>

        </div>
        

    </div>

	 
    <div class="content-section-a">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">SmartMeter Camera Software</h2>
                    

<style>
img {
  max-width: 100%;
  height: auto;
}
</style>

<p>The SmartMeter software runs on the Raspberry Pi. It takes pictures and uploads them to Dropbox. The central script <code>smeter.sh</code> controls all functions.</p>

<p>For installation instruction see <a href="https://github.com/cdeck3r/SmartMeter/blob/master/install_raspi.md">install_raspi.md</a>.</p>

<h3 id="scheduling">Scheduling</h3>

<p>An external timer switch powers-on the Raspberry Pi at pre-defined time. After the reboot the crontab runs the central control script <a href="https://github.com/cdeck3r/SmartMeter/blob/master/raspi/smeter.sh"><code>smeter.sh</code></a>, which takes the pictures (<code>takepicture.sh</code>) and uploads them to Dropbox (<code>fileservice.sh</code>). At the end, the script shuts down the Raspberry Pi. At a later time, the external timer switch powers-off.</p>

<p>The timer switch has only 28 slots for defining on and off times. This is not sufficient for 15 min intervals per hour. We define a coarse-grained timer duty cycle of 50% within 1 hour, which consists of 30 min power-on duty and 30 min when the Raspberry is powered off. In the power-on duty time, the <code>smeter.sh</code> control script performs three measurement activities at 0, 15, 30 min after the start. This schedule achieves three 15 min intervals and leaves out one within a hour. The exact schedule deviates a bit from this description in order to give time management activities to take place before the external timer switch powers-off. The sleep delay after the cron scheduler starts gives time for the OS to bring the ressources online. The following figure depicts the schedule.</p>

<p><img src="uml/sd_schedule.png" alt="SmartMeter software on Raspi" /></p>

<p>The schedule repeats as soon as the external timer switch powers-on the Raspberry Pi again.</p>

<h3 id="maintenance-mode">Maintenance Mode</h3>

<p>The above schedule makes it difficult to do maintenance activities. A developer needs to login after the bootup and stop the <code>smeter.sh</code> script before the Raspberry Pi shuts down.</p>

<p><strong>Maintenance mode:</strong></p>

<blockquote>
<p>The control script checks for a USB thumb drive at its startup. If it finds the file <code>maintenance</code> in the root directory, it will disable the shutdown at the end of <code>smeter.sh</code> control script.</p>
</blockquote>

<p>The developer has to set the external time switch to permanent on in order to avoid further powers-off.</p>

<p>The <a href="https://github.com/cdeck3r/SmartMeter/blob/master/raspi/maintenance.sh"><code>maintenance.sh</code></a> script implements the check for the maintenance mode. The following figure depicts the maintenance mode setting in <code>smeter.sh</code> as an activity diagram.</p>

<p><img src="uml/ac_maintenance.png" alt="Maintenance mode of the SmartMeter camera software"/></p>

<h3 id="log-rotation">Log Rotation</h3>

<p>We use standard linux tool <code>logrotate</code>. The config file defines the parameters and resides in the same directory as the other scripts. <code>logrotate.sh</code> has the following functions:</p>

<ol>
<li>Call the linux tool <code>logrotate</code></li>
<li>Upload the logfiles to dropbox</li>
</ol>

<p>The central control script <code>smeter.sh</code> calls the <code>logrotate.sh</code> after the picture upload.</p>

                </div>
            </div>

        </div>
        

    </div>

	
    <div class="content-section-b">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">Insights</h2>
                    <p>The energy consumption report depicts our consumption profile. It reveals patterns which correspond to the behavior of the house&rsquo;s residents. This section exploit statistical regularities to derives some measures optimizing our energy footprint. Concretely, we want to reduce the idle consumption, i.e. the energy usage when devices are not in use.</p>

<p>&hellip;</p>

                </div>
            </div>

        </div>
        

    </div>

	 
    <div class="content-section-a">
    
   
        <div class="container">

            <div class="row">
                <div>
                    
                    <h2 class="section-heading">Conclusion</h2>
                    <p>SmartMeter records the overall electricity consumption in a family home. It augments a regular electricity meter with an COTS embedded camera system. A server software creates a consumption report providing insights in energy usage patterns.</p>

<p>The list below displays the achieved objectives:</p>

<ul class="task-list">
<li><label><input type="checkbox" disabled class="task-list-item"> reliably taking pictures</label></li>
<li><label><input type="checkbox" disabled class="task-list-item"> data management across various systems at home as well as on the Internet</label></li>
<li><label><input type="checkbox" disabled class="task-list-item"> AI based optical character recognition</label></li>
<li><label><input type="checkbox" disabled class="task-list-item"> unattended operation</label></li>
<li><label><input type="checkbox" disabled class="task-list-item"> fine-grained consumption statistics</label></li>
</ul>

<p>In the current design, data is stored and processed on an Internet server outside the physical boundaries of the house. In a future SmartMeter implementation, all processing and data handling will be performed on the embedded camera system. This will improve the situation on privacy and data protection.</p>

                </div>
            </div>

        </div>
        

    </div>


</section>


<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-8" style="padding-left: 0px; width:100%">
				<ul class="list-inline">
					<li>
						<a class="page-scroll" href="#intro">Up</a>
					</li>
					<li class="footer-menu-divider">&sdot;</li>
						<li>
							<a href="https://cdeck3r.com/SmartMeter/imprint-gdpr/imprint" >Imprint</a>
						</li>
					<li class="footer-menu-divider">&sdot;</li>
						<li>
							<a href="https://cdeck3r.com/SmartMeter/imprint-gdpr/gdpr" >GDPR</a>
						</li>
				 </ul>
				 <p class="copyright text-muted small" style="text-align:left;">
                    Copyright &copy; SmartMeter All Rights Reserved 
                        </br>Built with <a href="http://gohugo.io">Hugo</a> and the <a href="https://github.com/cdeck3r/OneDly-Theme">OneDly project</a> theme.
                 </p>
			</div>
            
        </div>
    </div>
</footer>

<script src="js/jquery-1.11.0.js"></script>


<script src="js/jquery.easing.min.js"></script>


<script src="js/bootstrap.min.js"></script>



</body>
</html>

